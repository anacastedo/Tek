<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <title>GitHub Profile Manager</title>
  <link rel="stylesheet" href="css/styles.css">

</head>

<body>
  <nav class="nav">
    <a class="nav-link active" aria-current="page" href="#">Home</a>
    <a class="nav-link" href="all.html">Up-to-date Database</a>
    <a class="nav-link" href="compare.html">Compare</a>
  </nav>
  <h1>Profile and Repos Manager</h1>
  <div class="search-area">
    <input type="text" name="" id="username" placeholder="Enter Github Username" autocomplete="off">
    <button class="button" onclick="getDetails();">Get Details</button>
    <button class="button" onclick="addUser();">Add User</button>
  </div>
  <div class="output-container" id="output">
    <div class="profile" id="profile"></div>
    <div class="username">
      <h1 id="name"></h1>
    </div>
    <div class="bio">
      <p id="bio"></p>
    </div>
    <div class="info">
      <ul>
        <li id="followers"></li>
        <li id="following"></li>
        <li id="repos"></li>
      </ul>
    </div>
  </div>
  <script>
    let name;

    function getDetails() {
      document.getElementById('output').style.display = "block";
      name = document.getElementById('username').value;
      fetch(`https://api.github.com/users/${name}`)
        .then(response => response.json().then(data1 => {
          document.getElementById('name').innerHTML = data1.name;
          document.getElementById('bio').innerHTML = data1.bio;
          document.getElementById('followers').innerHTML = data1.followers + " Followers";
          document.getElementById('following').innerHTML = data1.following + " Following";
          document.getElementById('repos').innerHTML = data1.public_repos + " Public Repos";
          document.getElementById('profile').innerHTML = `
                <img src="${data1.avatar_url}" />
                `
        }))
    };

    function addUser() {
      name = document.getElementById('username').value;
      fetch(`https://api.github.com/users/${name}`)
        .then(response => response.json().then(data => {
          console.log(data);
          console.log(data.login);
          const name = data.name;
          const bio = data.bio;
          const followers = data.followers;
          const following = data.following;
          const repos = data.public_repos;
          const profile = data.avatar_url;
          const log = data.login;
          document.getElementById('name').textContent = data.name;
          document.getElementById('bio').textContent = data.bio;
          document.getElementById('repos').textContent = data.repos;
          document.getElementById('followers').textContent = data.followers + " Followers";
          document.getElementById('following').textContent = data.following + " Following";
          document.getElementById('repos').textContent = data.public_repos + " Public Repos";
          document.getElementById('profile').src = data.avatar_url;



          const dataToProcess = {
            name,
            bio,
            followers,
            following,
            repos,
            profile,
            log
          };
          const options = {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(dataToProcess)
          };
          fetch('/api', options).then(response => response.json().then(data => {
            console.log(data);

          }));

        }))

    };
  </script>


</body>

</html>

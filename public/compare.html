<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <link rel="icon" type="image/x-icon" href="/images/favicon.ico">
    <title>Profile Comparison</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100;0,200;0,400;0,500;0,700;0,800;1,100&display=swap" rel="stylesheet">

  </head>
  <body>
    <nav class="nav">
      <a class="nav-link" href="index.html">Home</a>
      <a class="nav-link" href="all.html">Database</a>
      <a class="nav-link active" aria-current="page" href="#">Compare</a>
    </nav>
    <h1>Profile Comparison</h1>
    <div class="search-area">
      <input type="text" name="" class="user_c" id="username1" placeholder="Enter Github Username1" autocomplete="off">
      <input type="text" name="" class="user_" id="username2" placeholder="Enter Github Username2" autocomplete="off">
      <button class="button" onclick="getDataToCompare(0);">Compare</button>

    </div>



<!-- Trigger/Open The Modal -->
<!-- Trigger/Open The Modal -->
<button id="modalBtn">Consult Database</button>
<a onClick="window.location.reload()">Refresh</a>

<!-- The Modal <script src="compare.js"></script>-->
<div id="myModal" class="modal">
  <!-- Modal content -->
  <div class="modal-content" id="demo">
    <span class="close">&times;</span>
    <p>
            <button class="button" id="btn">Compare</button>
        </p>

  </div>

</div>



  <!--  <a class="button" href="all.html">Consult Database</a> -->
<h2 id="compare_title"></h2>



<script src="compare.js"></script>
<script>
let username1, username2;
// Get the modal
var modal = document.getElementById("myModal");

// Get the button that opens the modal
var btn = document.getElementById("modalBtn");

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];

// When the user clicks on the button, open the modal
btn.onclick = function() {
modal.style.display = "block";

}

// When the user clicks on <span> (x), close the modal
span.onclick = function() {
modal.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
if (event.target == modal) {
  modal.style.display = "none";
}
}

let log, i=0;
getData();
async function getData() {
  i=0;
  const response = await fetch('/api');
  const data = await response.json();

  const table = document.createElement('table');
  table.setAttribute("id","compare_table");
  demo.appendChild(table);

  for (item of data) {
    i++;
    const row=document.createElement("tr");
    row.setAttribute("id", `row_${i}`);
    row.setAttribute("class", "compare_row");
    document.getElementById("compare_table").appendChild(row);

    const input=document.createElement("input");
    input.setAttribute("id", `input_${i}`);
    input.setAttribute("type", "checkbox");
    input.setAttribute("class", "checkbox_db");
    input.setAttribute("name", "usernames_input");
    input.setAttribute("value", `${item.log}`);
    document.getElementById(`row_${i}`).appendChild(input);

    const label_c=document.createElement("label");
    label_c.setAttribute("id", `label_${i}`);
    label_c.setAttribute("for", `input_${i}`);
    document.getElementById(`input_${i}`).appendChild(label_c);

    const log_info = document.createTextNode(`Username: ${item.log}`);
    const name_info = document.createTextNode(`Name: ${item.name}`);
    document.getElementById(`label_${i}`).appendChild(log_info);
    document.getElementById(`row_${i}`).appendChild(label_c);
  };
    const btn = document.querySelector('#btn');
    btn.addEventListener('click', (event) => {
        let checkboxes = document.querySelectorAll('input[name="usernames_input"]:checked');
        let values = [];
        checkboxes.forEach((checkbox) => {
            values.push(checkbox.value);
        });
        alert(values);

        username1=values[0];
        username2=values[1];
        getDataToCompare(username1, username2);
    });



  console.log(data);
};



</script>

</body>
</html>
